<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>やっちゃん誕生会｜当日登録</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{background:#f5f6fa;}
.header{background:#004fa3;color:white;padding:12px;font-size:18px;text-align:center;}
.timeBox{border:1px solid #ddd;border-radius:10px;overflow:hidden;}
.slot{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #eee;background:#f7f7f7;}
.slot:last-child{border-bottom:none;}
.icon{font-size:20px;margin-right:10px;}
.ok{color:#2b8a3e;}
.mid{color:#e6a000;}
.bad{color:#d00000;}
.modal-mask{
position:fixed;top:0;left:0;width:100%;height:100%;
background:rgba(0,0,0,0.55);display:none;justify-content:center;align-items:center;
}
.modal-card{
background:white;border-radius:12px;padding:20px;width:88%;max-width:420px;text-align:center;
}
.spinner-border{width:2.5rem;height:2.5rem;}
</style>

</head>
<body>

<div class="header">
当日登録（やっちゃん誕生会）
</div>

<div class="container mt-4">

<div class="card p-3">
<p class="text-muted mb-2">開催日：<b>2025年12月30日(火)</b></p>
<p class="text-muted mb-3">参加枠状況</p>

<div class="timeBox">

<div class="slot">
<div><span class="icon bad">✕</span>18:00〜</div>
<div class="text-muted small">満席</div>
</div>

<div class="slot selectable" id="mid1">
<div><span class="icon mid">△</span>18:30〜</div>
<div class="text-danger small">混雑中</div>
</div>

<div class="slot">
<div><span class="icon bad">✕</span>19:00〜</div>
<div class="text-muted small">満席</div>
</div>

<div class="slot selectable" id="mid2">
<div><span class="icon mid">△</span>二次会から参加</div>
<div class="text-danger small">混雑中</div>
</div>

</div>

<p class="text-muted mt-3 small">
※ 状況により選択できない場合があります
</p>

</div>
</div>

<!-- LOADING / RESULT MODAL -->
<div class="modal-mask" id="modal">
<div class="modal-card" id="modalContent">

<div id="loading">
<div class="spinner-border text-primary mb-3"></div>
<p class="fw-bold">処理中です</p>
<p class="text-muted small">しばらくお待ちください…</p>
</div>

<div id="fail" style="display:none;">
<h5 class="mb-3">予約が確保できませんでした</h5>
<p class="text-muted mb-3" id="failText"></p>
<button class="btn btn-outline-dark w-100" onclick="closeModal()">とじる</button>
</div>

<div id="success" style="display:none;">
<h5 class="mb-3">予約が完了しました</h5>
<p class="text-muted mb-3">当日のご参加をお待ちしております。</p>
<button class="btn btn-dark w-100" onclick="closeModal()">とじる</button>
</div>

</div>
</div>

<script>
const modal = document.getElementById("modal");
const loading = document.getElementById("loading");
const fail = document.getElementById("fail");
const success = document.getElementById("success");
const failText = document.getElementById("failText");

const failMessages = [
 "現在アクセスが集中しています。時間をあけて再度お試しください。",
 "定員を超えたため、選択された時間帯は受付停止中です。",
 "通信状態が不安定のため、予約を完了できませんでした。（E-1421）",
 "直前の混雑により、対象枠は締め切られました。",
 "処理中にエラーが発生しました。もう一度やり直してください。"
];

function showModal(){
 modal.style.display = "flex";
 loading.style.display="block";
 fail.style.display="none";
 success.style.display="none";

 setTimeout(()=>{
 let chance = Math.random();

 if(chance < 0.97){
    loading.style.display="none";
    fail.style.display="block";
    failText.innerText = failMessages[Math.floor(Math.random()*failMessages.length)];
 } else {
    loading.style.display="none";
    success.style.display="block";
 }
 },1600);
}

function closeModal(){
 modal.style.display="none";
}

document.getElementById("mid1").onclick = showModal;
document.getElementById("mid2").onclick = showModal;
</script>

</body>
</html>
