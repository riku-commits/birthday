<!-- â–¼ æˆåŠŸãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ï¼ˆæœ¬å®¶å¯„ã›ï¼‰ -->
<div id="successPopup" class="modalBg">
  <div class="popupCard">
    <div class="popupTitle">
      ï¼œ ç©ºãæ ç™ºè¦‹ ï¼<br>
      ãƒ‘ãƒ“ãƒªã‚ªãƒ³/ã‚¤ãƒ™ãƒ³ãƒˆãŒ<br>
      äºˆç´„ã•ã‚Œã¾ã—ãŸ
    </div>

    <div class="popupIcon">
      ğŸ“…ğŸ•’
    </div>

    <div class="popupTime">
      å‚åŠ æ™‚é–“ï¼š<span id="successTimeText"></span>
    </div>

    <button class="popupBtn">ã¨ã˜ã‚‹</button>
  </div>
</div>


<!-- â–¼ QRç”»é¢ -->
<div id="qrShow" class="modalBg">
  <div class="modal">
    <div class="big-text">å…¥å ´ç”¨QRã‚³ãƒ¼ãƒ‰</div>

    <div class="qrOuter">
      <!-- â–¼ ã‚ˆã‚Šæœ¬ç‰©å¯„ã›QR -->
      <div class="realQR">
        <div class="finder tl"></div>
        <div class="finder tr"></div>
        <div class="finder bl"></div>
        <canvas id="qrCanvas" width="220" height="220"></canvas>
      </div>
    </div>

    <p>
      ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿å­˜ã—ã€<br>
      å½“æ—¥ã®å…¥å ´æ™‚ã«æç¤ºã—ã¦ãã ã•ã„ã€‚
    </p>

    <button onclick="closeAll()">ã¨ã˜ã‚‹</button>
  </div>
</div>

<style>
/* ã™ã§ã«ã‚ã‚‹ modalBg ã¯æµç”¨ */

.popupCard{
  background:white;
  border-radius:12px;
  padding:20px;
  width:290px;
  text-align:center;
}

.popupTitle{
  font-size:16px;
  font-weight:bold;
  line-height:28px;
}

.popupIcon{
  font-size:40px;
  margin:10px 0;
}

.popupTime{
  font-size:13px;
  margin:8px 0 12px;
}

.popupBtn{
  width:100%;
  padding:10px;
  border:1px solid #444;
  border-radius:6px;
  background:white;
}

/* QRå¼·åŒ– */
.qrOuter{
  padding:12px;
  border:3px solid #111;
  display:inline-block;
}

.realQR{
  width:240px;
  height:240px;
  position:relative;
}

/* 3ã¤ã®è§’ã®é»’æ ï¼ˆæœ¬ç‰©ã‚‰ã—ã•ã®è¶…é‡è¦è¦ç´ ï¼‰ */
.finder{
  width:60px;
  height:60px;
  border:8px solid #000;
  position:absolute;
}
.tl{top:0;left:0;}
.tr{top:0;right:0;}
.bl{bottom:0;left:0;}
</style>

<script>
// ---- äºˆç´„æˆåŠŸå‡¦ç† ----
function showSuccess(time){
  document.getElementById("successTimeText").innerText = time;
  document.getElementById("successPopup").style.display="flex";

  setTimeout(()=>{
    document.getElementById("successPopup").style.display="none";
    showQR();
  },10000);
}

// ---- æœ¬ç‰©å¯„ã›QRç”Ÿæˆï¼ˆãƒ‰ãƒƒãƒˆã‚’ãƒ©ãƒ³ãƒ€ãƒ æç”»ï¼‰ ----
function showQR(){

  const qr = document.getElementById("qrCanvas");
  const ctx = qr.getContext("2d");

  ctx.fillStyle="white";
  ctx.fillRect(0,0,220,220);

  ctx.fillStyle="black";
  for(let y=0; y<22; y++){
    for(let x=0; x<22; x++){

      // è§’ã® finder ã‚’é¿ã‘ã‚‹
      if((x<5 && y<5) || (x>16 && y<5) || (x<5 && y>16)) continue;

      if(Math.random()>0.55){
        ctx.fillRect(x*10, y*10, 9, 9);
      }
    }
  }

  document.getElementById("qrShow").style.display="flex";
}

function closeAll(){
  document.querySelectorAll(".modalBg").forEach(m=>m.style.display="none");
}
</script>
