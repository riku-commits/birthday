<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>やっちゃん誕生日会 参加予約</title>

<style>
body{
  font-family: "Yu Gothic","Segoe UI",-apple-system,BlinkMacSystemFont,sans-serif;
  background:#f2f4f7;
  margin:0;
}

/* --- EXPO風ヘッダー --- */
.header{
  background:#005bac;
  color:#fff;
  padding:10px 18px;
  font-size:18px;
  font-weight:bold;
}

/* --- コンテナ --- */
.box{
  width:850px;
  margin:30px auto;
  background:#fff;
  border-radius:8px;
  padding:22px 30px 35px 30px;
  box-shadow:0 2px 8px rgba(0,0,0,0.2);
}

/* --- 見出し --- */
.title{
  font-size:18px;
  font-weight:bold;
  margin-bottom:10px;
}

/* --- 時間帯リスト --- */
.timeRow{
  display:flex;
  align-items:center;
  border:1px solid #ddd;
  padding:14px;
  margin-top:8px;
  border-radius:6px;
}

.icon{
  width:30px;
  font-size:20px;
  font-weight:bold;
}

.circle{ color:#0094ff; }
.tri{ color:#e0b000; }
.cross{ color:#ff0033; }

.timeText{
  flex:1;
  font-size:16px;
}

.sel input{
  width:18px;
  height:18px;
}

/* --- 下部のボタン --- */
.notice{
  background:#ffecec;
  padding:12px;
  margin-top:20px;
  border:1px solid #ffbbbb;
  text-align:center;
}

.bottomBtn{
  background:#d6000f;
  color:white;
  padding:14px;
  text-align:center;
  border-radius:4px;
  margin-top:16px;
  cursor:pointer;
  font-size:16px;
}

/* --- モーダル（EXPO風） --- */
.modalCover{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.75);
  display:flex;
  justify-content:center;
  align-items:center;
  visibility:hidden;
}

.modal{
  width:380px;
  background:#fff;
  padding:24px;
  border-radius:10px;
  text-align:center;
}

.modal x{
  float:right;
}

.bigok{
  font-size:17px;
  margin-top:10px;
}

/* --- 順番待ち画面 --- */
.queue{
  text-align:center;
}

.bar{
  width:92%;
  height:22px;
  background:#ccc;
  margin:14px auto;
  border-radius:8px;
  overflow:hidden;
}
.fill{
  height:100%;
  width:0%;
  background:#1fae4a;
}

</style>
</head>

<body>

<div class="header">やっちゃん誕生日会 参加予約</div>

<div class="box">

<div class="title">2025年12月30日 (火)</div>

<div id="list"></div>

<div class="notice">○ … 空きあり　　△ … 少し混雑　　× … 満員（予約不可）</div>

<div class="bottomBtn" onclick="reserve()">この時間で参加する →</div>

</div>


<!-- 成功 / 失敗モーダル -->
<div class="modalCover" id="modalCover">
  <div class="modal" id="modalBox">
    <div id="modalText"></div>
    <div style="margin-top:18px;">
      <div class="bottomBtn" onclick="closeModal()" style="width:200px;margin:auto;">
        とじる
      </div>
    </div>
  </div>
</div>


<!-- 順番待ちページ -->
<div class="modalCover" id="queuePage">
  <div class="modal queue">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Expo_2025_logo.svg/512px-Expo_2025_logo.svg.png" width="140"><br>
    <b>順番にご案内しております。</b><br><br>
    現在サイトが大変混雑しております。<br>
    しばらくそのままでお待ちください。<br><br>

    <div class="bar"><div class="fill" id="fillBar"></div></div>

    <div id="queueMsg">待ち時間目安：数秒</div>
  </div>
</div>


<script>
let times = [
"18:00〜","18:20〜","18:40〜","19:00〜",
"19:20〜","19:40〜","20:00〜","20:20〜"
];

function r(){
 let n = Math.random();
 return n<0.33?"○":n<0.66?"△":"×";
}

function draw(){
 let h="";
 times.forEach((t,i)=>{
  let mark = r();
  let cls = mark=="○"?"circle":mark=="△"?"tri":"cross";
  let disable = mark=="×"?"disabled":"";
  h += `
  <div class="timeRow">
    <div class="icon ${cls}">${mark}</div>
    <div class="timeText">${t}</div>
    <div class="sel"><input name="t" type="radio" ${disable}></div>
  </div>
  `;
 });
 document.getElementById("list").innerHTML=h;
}

draw();


// --------------------
// 予約ボタン
// --------------------
function reserve(){

  let r = Math.random();

  // 10% → 強制的に「順番待ち画面」
  if(r<0.10){
    queue();
    return;
  }

  document.getElementById("modalCover").style.visibility="visible";
  document.getElementById("modalText").innerHTML=
  "しばらくお待ちください…<br><br>処理をしています。";

  // EXPO風 → 無駄に遅い
  setTimeout(()=>{
    let result = Math.random();

    if(result<0.25){
      // 失敗
      document.getElementById("modalText").innerHTML=
      "<b>＜ 空き枠先着 ＞</b><br><br>誕生日会の参加予約が<br>確保できませんでした…<br><br>お手数ですが再度お試しください";
    }else{
      // 成功
      document.getElementById("modalText").innerHTML=
      "<b>＜ 空き枠先着 ＞</b><br><br>誕生日会の参加予約が<br><span class='bigok'>確定しました！</span><br><br>集合時間：19:40〜";
    }

  },2500);
}

function closeModal(){
 document.getElementById("modalCover").style.visibility="hidden";
 draw();
}


// --------------------
// 順番待ち
// --------------------
function queue(){
 document.getElementById("queuePage").style.visibility="visible";

 let fill = 0;
 let timer = setInterval(()=>{
   fill += 5;
   document.getElementById("fillBar").style.width=fill+"%";
   if(fill>=100){
     clearInterval(timer);
     document.getElementById("queuePage").style.visibility="hidden";
   }
 },220);
}
</script>

</body>
</html>
